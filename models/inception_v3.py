#!usr/bin/python
# -*- coding: utf-8 -*-
# @Time: 2021/10/8 16:29
# @Author: Chen Jizhi
# @E-mail: chenjizhi@ruijie.com
# @File: inception_v3.py
# @Software: PyCharm


import torch
import torch.nn as nn


class InceptionV3(nn.Module):

    def __init__(self, num_classes):
        super(InceptionV3, self).__init__()
        self.meta = {'mean': [0.485, 0.456, 0.406],
                     'std': [0.229, 0.224, 0.225],
                     'imageSize': [299, 299]}
        self.features_0_conv = nn.Conv2d(3, 32, kernel_size=[3, 3], stride=(2, 2), bias=False)
        self.features_0_bn = nn.BatchNorm2d(32, eps=0.001, momentum=0.1, affine=True)
        self.features_0_relu = nn.ReLU()
        self.features_1_conv = nn.Conv2d(32, 32, kernel_size=[3, 3], stride=(1, 1), bias=False)
        self.features_1_bn = nn.BatchNorm2d(32, eps=0.001, momentum=0.1, affine=True)
        self.features_1_relu = nn.ReLU()
        self.features_2_conv = nn.Conv2d(32, 64, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_2_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_2_relu = nn.ReLU()
        self.features_3 = nn.MaxPool2d(kernel_size=(3, 3), stride=(2, 2), dilation=(1, 1), ceil_mode=False)
        self.features_4_conv = nn.Conv2d(64, 80, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_4_bn = nn.BatchNorm2d(80, eps=0.001, momentum=0.1, affine=True)
        self.features_4_relu = nn.ReLU()
        self.features_5_conv = nn.Conv2d(80, 192, kernel_size=[3, 3], stride=(1, 1), bias=False)
        self.features_5_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_5_relu = nn.ReLU()
        self.features_6 = nn.MaxPool2d(kernel_size=(3, 3), stride=(2, 2), dilation=(1, 1), ceil_mode=False)
        self.features_7_branch1x1_conv = nn.Conv2d(192, 64, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_7_branch1x1_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_7_branch1x1_relu = nn.ReLU()
        self.features_7_branch5x5_1_conv = nn.Conv2d(192, 48, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_7_branch5x5_1_bn = nn.BatchNorm2d(48, eps=0.001, momentum=0.1, affine=True)
        self.features_7_branch5x5_1_relu = nn.ReLU()
        self.features_7_branch5x5_2_conv = nn.Conv2d(48, 64, kernel_size=[5, 5], stride=(1, 1), padding=(2, 2), bias=False)
        self.features_7_branch5x5_2_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_7_branch5x5_2_relu = nn.ReLU()
        self.features_7_branch3x3dbl_1_conv = nn.Conv2d(192, 64, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_7_branch3x3dbl_1_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_7_branch3x3dbl_1_relu = nn.ReLU()
        self.features_7_branch3x3dbl_2_conv = nn.Conv2d(64, 96, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_7_branch3x3dbl_2_bn = nn.BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True)
        self.features_7_branch3x3dbl_2_relu = nn.ReLU()
        self.features_7_branch3x3dbl_3_conv = nn.Conv2d(96, 96, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_7_branch3x3dbl_3_bn = nn.BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True)
        self.features_7_branch3x3dbl_3_relu = nn.ReLU()
        self.features_7_branch_avgpool = nn.AvgPool2d(kernel_size=[3, 3], stride=[1, 1], padding=1, ceil_mode=False, count_include_pad=False)
        self.features_7_branch_pool_conv = nn.Conv2d(192, 32, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_7_branch_pool_bn = nn.BatchNorm2d(32, eps=0.001, momentum=0.1, affine=True)
        self.features_7_branch_pool_relu = nn.ReLU()
        self.features_8_branch1x1_conv = nn.Conv2d(256, 64, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_8_branch1x1_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_8_branch1x1_relu = nn.ReLU()
        self.features_8_branch5x5_1_conv = nn.Conv2d(256, 48, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_8_branch5x5_1_bn = nn.BatchNorm2d(48, eps=0.001, momentum=0.1, affine=True)
        self.features_8_branch5x5_1_relu = nn.ReLU()
        self.features_8_branch5x5_2_conv = nn.Conv2d(48, 64, kernel_size=[5, 5], stride=(1, 1), padding=(2, 2), bias=False)
        self.features_8_branch5x5_2_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_8_branch5x5_2_relu = nn.ReLU()
        self.features_8_branch3x3dbl_1_conv = nn.Conv2d(256, 64, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_8_branch3x3dbl_1_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_8_branch3x3dbl_1_relu = nn.ReLU()
        self.features_8_branch3x3dbl_2_conv = nn.Conv2d(64, 96, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_8_branch3x3dbl_2_bn = nn.BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True)
        self.features_8_branch3x3dbl_2_relu = nn.ReLU()
        self.features_8_branch3x3dbl_3_conv = nn.Conv2d(96, 96, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_8_branch3x3dbl_3_bn = nn.BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True)
        self.features_8_branch3x3dbl_3_relu = nn.ReLU()
        self.features_8_branch_avgpool = nn.AvgPool2d(kernel_size=[3, 3], stride=[1, 1], padding=1, ceil_mode=False, count_include_pad=False)
        self.features_8_branch_pool_conv = nn.Conv2d(256, 64, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_8_branch_pool_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_8_branch_pool_relu = nn.ReLU()
        self.features_9_branch1x1_conv = nn.Conv2d(288, 64, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_9_branch1x1_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_9_branch1x1_relu = nn.ReLU()
        self.features_9_branch5x5_1_conv = nn.Conv2d(288, 48, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_9_branch5x5_1_bn = nn.BatchNorm2d(48, eps=0.001, momentum=0.1, affine=True)
        self.features_9_branch5x5_1_relu = nn.ReLU()
        self.features_9_branch5x5_2_conv = nn.Conv2d(48, 64, kernel_size=[5, 5], stride=(1, 1), padding=(2, 2), bias=False)
        self.features_9_branch5x5_2_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_9_branch5x5_2_relu = nn.ReLU()
        self.features_9_branch3x3dbl_1_conv = nn.Conv2d(288, 64, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_9_branch3x3dbl_1_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_9_branch3x3dbl_1_relu = nn.ReLU()
        self.features_9_branch3x3dbl_2_conv = nn.Conv2d(64, 96, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_9_branch3x3dbl_2_bn = nn.BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True)
        self.features_9_branch3x3dbl_2_relu = nn.ReLU()
        self.features_9_branch3x3dbl_3_conv = nn.Conv2d(96, 96, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_9_branch3x3dbl_3_bn = nn.BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True)
        self.features_9_branch3x3dbl_3_relu = nn.ReLU()
        self.features_9_branch_avgpool = nn.AvgPool2d(kernel_size=[3, 3], stride=[1, 1], padding=1, ceil_mode=False, count_include_pad=False)
        self.features_9_branch_pool_conv = nn.Conv2d(288, 64, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_9_branch_pool_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_9_branch_pool_relu = nn.ReLU()
        self.features_10_branch3x3_conv = nn.Conv2d(288, 384, kernel_size=[3, 3], stride=(2, 2), bias=False)
        self.features_10_branch3x3_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_10_branch3x3_relu = nn.ReLU()
        self.features_10_branch3x3dbl_1_conv = nn.Conv2d(288, 64, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_10_branch3x3dbl_1_bn = nn.BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True)
        self.features_10_branch3x3dbl_1_relu = nn.ReLU()
        self.features_10_branch3x3dbl_2_conv = nn.Conv2d(64, 96, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_10_branch3x3dbl_2_bn = nn.BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True)
        self.features_10_branch3x3dbl_2_relu = nn.ReLU()
        self.features_10_branch3x3dbl_3_conv = nn.Conv2d(96, 96, kernel_size=[3, 3], stride=(2, 2), bias=False)
        self.features_10_branch3x3dbl_3_bn = nn.BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True)
        self.features_10_branch3x3dbl_3_relu = nn.ReLU()
        self.features_10_branch_pool = nn.MaxPool2d(kernel_size=(3, 3), stride=(2, 2), dilation=(1, 1), ceil_mode=False)
        self.features_11_branch1x1_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_11_branch1x1_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch1x1_relu = nn.ReLU()
        self.features_11_branch7x7_1_conv = nn.Conv2d(768, 128, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_11_branch7x7_1_bn = nn.BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch7x7_1_relu = nn.ReLU()
        self.features_11_branch7x7_2_conv = nn.Conv2d(128, 128, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_11_branch7x7_2_bn = nn.BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch7x7_2_relu = nn.ReLU()
        self.features_11_branch7x7_3_conv = nn.Conv2d(128, 192, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_11_branch7x7_3_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch7x7_3_relu = nn.ReLU()
        self.features_11_branch7x7dbl_1_conv = nn.Conv2d(768, 128, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_11_branch7x7dbl_1_bn = nn.BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch7x7dbl_1_relu = nn.ReLU()
        self.features_11_branch7x7dbl_2_conv = nn.Conv2d(128, 128, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_11_branch7x7dbl_2_bn = nn.BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch7x7dbl_2_relu = nn.ReLU()
        self.features_11_branch7x7dbl_3_conv = nn.Conv2d(128, 128, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_11_branch7x7dbl_3_bn = nn.BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch7x7dbl_3_relu = nn.ReLU()
        self.features_11_branch7x7dbl_4_conv = nn.Conv2d(128, 128, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_11_branch7x7dbl_4_bn = nn.BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch7x7dbl_4_relu = nn.ReLU()
        self.features_11_branch7x7dbl_5_conv = nn.Conv2d(128, 192, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_11_branch7x7dbl_5_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch7x7dbl_5_relu = nn.ReLU()
        self.features_11_branch_avgpool = nn.AvgPool2d(kernel_size=[3, 3], stride=[1, 1], padding=1, ceil_mode=False, count_include_pad=False)
        self.features_11_branch_pool_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_11_branch_pool_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_11_branch_pool_relu = nn.ReLU()
        self.features_12_branch1x1_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_12_branch1x1_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch1x1_relu = nn.ReLU()
        self.features_12_branch7x7_1_conv = nn.Conv2d(768, 160, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_12_branch7x7_1_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch7x7_1_relu = nn.ReLU()
        self.features_12_branch7x7_2_conv = nn.Conv2d(160, 160, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_12_branch7x7_2_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch7x7_2_relu = nn.ReLU()
        self.features_12_branch7x7_3_conv = nn.Conv2d(160, 192, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_12_branch7x7_3_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch7x7_3_relu = nn.ReLU()
        self.features_12_branch7x7dbl_1_conv = nn.Conv2d(768, 160, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_12_branch7x7dbl_1_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch7x7dbl_1_relu = nn.ReLU()
        self.features_12_branch7x7dbl_2_conv = nn.Conv2d(160, 160, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_12_branch7x7dbl_2_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch7x7dbl_2_relu = nn.ReLU()
        self.features_12_branch7x7dbl_3_conv = nn.Conv2d(160, 160, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_12_branch7x7dbl_3_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch7x7dbl_3_relu = nn.ReLU()
        self.features_12_branch7x7dbl_4_conv = nn.Conv2d(160, 160, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_12_branch7x7dbl_4_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch7x7dbl_4_relu = nn.ReLU()
        self.features_12_branch7x7dbl_5_conv = nn.Conv2d(160, 192, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_12_branch7x7dbl_5_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch7x7dbl_5_relu = nn.ReLU()
        self.features_12_branch_avgpool = nn.AvgPool2d(kernel_size=[3, 3], stride=[1, 1], padding=1, ceil_mode=False, count_include_pad=False)
        self.features_12_branch_pool_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_12_branch_pool_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_12_branch_pool_relu = nn.ReLU()
        self.features_13_branch1x1_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_13_branch1x1_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch1x1_relu = nn.ReLU()
        self.features_13_branch7x7_1_conv = nn.Conv2d(768, 160, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_13_branch7x7_1_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch7x7_1_relu = nn.ReLU()
        self.features_13_branch7x7_2_conv = nn.Conv2d(160, 160, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_13_branch7x7_2_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch7x7_2_relu = nn.ReLU()
        self.features_13_branch7x7_3_conv = nn.Conv2d(160, 192, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_13_branch7x7_3_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch7x7_3_relu = nn.ReLU()
        self.features_13_branch7x7dbl_1_conv = nn.Conv2d(768, 160, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_13_branch7x7dbl_1_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch7x7dbl_1_relu = nn.ReLU()
        self.features_13_branch7x7dbl_2_conv = nn.Conv2d(160, 160, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_13_branch7x7dbl_2_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch7x7dbl_2_relu = nn.ReLU()
        self.features_13_branch7x7dbl_3_conv = nn.Conv2d(160, 160, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_13_branch7x7dbl_3_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch7x7dbl_3_relu = nn.ReLU()
        self.features_13_branch7x7dbl_4_conv = nn.Conv2d(160, 160, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_13_branch7x7dbl_4_bn = nn.BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch7x7dbl_4_relu = nn.ReLU()
        self.features_13_branch7x7dbl_5_conv = nn.Conv2d(160, 192, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_13_branch7x7dbl_5_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch7x7dbl_5_relu = nn.ReLU()
        self.features_13_branch_avgpool = nn.AvgPool2d(kernel_size=[3, 3], stride=[1, 1], padding=1, ceil_mode=False, count_include_pad=False)
        self.features_13_branch_pool_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_13_branch_pool_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_13_branch_pool_relu = nn.ReLU()
        self.features_14_branch1x1_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_14_branch1x1_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch1x1_relu = nn.ReLU()
        self.features_14_branch7x7_1_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_14_branch7x7_1_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch7x7_1_relu = nn.ReLU()
        self.features_14_branch7x7_2_conv = nn.Conv2d(192, 192, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_14_branch7x7_2_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch7x7_2_relu = nn.ReLU()
        self.features_14_branch7x7_3_conv = nn.Conv2d(192, 192, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_14_branch7x7_3_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch7x7_3_relu = nn.ReLU()
        self.features_14_branch7x7dbl_1_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_14_branch7x7dbl_1_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch7x7dbl_1_relu = nn.ReLU()
        self.features_14_branch7x7dbl_2_conv = nn.Conv2d(192, 192, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_14_branch7x7dbl_2_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch7x7dbl_2_relu = nn.ReLU()
        self.features_14_branch7x7dbl_3_conv = nn.Conv2d(192, 192, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_14_branch7x7dbl_3_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch7x7dbl_3_relu = nn.ReLU()
        self.features_14_branch7x7dbl_4_conv = nn.Conv2d(192, 192, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_14_branch7x7dbl_4_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch7x7dbl_4_relu = nn.ReLU()
        self.features_14_branch7x7dbl_5_conv = nn.Conv2d(192, 192, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_14_branch7x7dbl_5_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch7x7dbl_5_relu = nn.ReLU()
        self.features_14_branch_avgpool = nn.AvgPool2d(kernel_size=[3, 3], stride=[1, 1], padding=1, ceil_mode=False, count_include_pad=False)
        self.features_14_branch_pool_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_14_branch_pool_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_14_branch_pool_relu = nn.ReLU()
        self.features_15_branch3x3_1_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_15_branch3x3_1_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_15_branch3x3_1_relu = nn.ReLU()
        self.features_15_branch3x3_2_conv = nn.Conv2d(192, 320, kernel_size=[3, 3], stride=(2, 2), bias=False)
        self.features_15_branch3x3_2_bn = nn.BatchNorm2d(320, eps=0.001, momentum=0.1, affine=True)
        self.features_15_branch3x3_2_relu = nn.ReLU()
        self.features_15_branch7x7x3_1_conv = nn.Conv2d(768, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_15_branch7x7x3_1_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_15_branch7x7x3_1_relu = nn.ReLU()
        self.features_15_branch7x7x3_2_conv = nn.Conv2d(192, 192, kernel_size=[1, 7], stride=(1, 1), padding=(0, 3), bias=False)
        self.features_15_branch7x7x3_2_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_15_branch7x7x3_2_relu = nn.ReLU()
        self.features_15_branch7x7x3_3_conv = nn.Conv2d(192, 192, kernel_size=[7, 1], stride=(1, 1), padding=(3, 0), bias=False)
        self.features_15_branch7x7x3_3_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_15_branch7x7x3_3_relu = nn.ReLU()
        self.features_15_branch7x7x3_4_conv = nn.Conv2d(192, 192, kernel_size=[3, 3], stride=(2, 2), bias=False)
        self.features_15_branch7x7x3_4_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_15_branch7x7x3_4_relu = nn.ReLU()
        self.features_15_branch_maxpool = nn.MaxPool2d(kernel_size=(3, 3), stride=(2, 2), dilation=(1, 1), ceil_mode=False)
        self.features_16_branch1x1_conv = nn.Conv2d(1280, 320, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_16_branch1x1_bn = nn.BatchNorm2d(320, eps=0.001, momentum=0.1, affine=True)
        self.features_16_branch1x1_relu = nn.ReLU()
        self.features_16_branch3x3_1_conv = nn.Conv2d(1280, 384, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_16_branch3x3_1_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_16_branch3x3_1_relu = nn.ReLU()
        self.features_16_branch3x3_2a_conv = nn.Conv2d(384, 384, kernel_size=[1, 3], stride=(1, 1), padding=(0, 1), bias=False)
        self.features_16_branch3x3_2a_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_16_branch3x3_2a_relu = nn.ReLU()
        self.features_16_branch3x3_2b_conv = nn.Conv2d(384, 384, kernel_size=[3, 1], stride=(1, 1), padding=(1, 0), bias=False)
        self.features_16_branch3x3_2b_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_16_branch3x3_2b_relu = nn.ReLU()
        self.features_16_branch3x3dbl_1_conv = nn.Conv2d(1280, 448, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_16_branch3x3dbl_1_bn = nn.BatchNorm2d(448, eps=0.001, momentum=0.1, affine=True)
        self.features_16_branch3x3dbl_1_relu = nn.ReLU()
        self.features_16_branch3x3dbl_2_conv = nn.Conv2d(448, 384, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_16_branch3x3dbl_2_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_16_branch3x3dbl_2_relu = nn.ReLU()
        self.features_16_branch3x3dbl_3a_conv = nn.Conv2d(384, 384, kernel_size=[1, 3], stride=(1, 1), padding=(0, 1), bias=False)
        self.features_16_branch3x3dbl_3a_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_16_branch3x3dbl_3a_relu = nn.ReLU()
        self.features_16_branch3x3dbl_3b_conv = nn.Conv2d(384, 384, kernel_size=[3, 1], stride=(1, 1), padding=(1, 0), bias=False)
        self.features_16_branch3x3dbl_3b_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_16_branch3x3dbl_3b_relu = nn.ReLU()
        self.features_16_branch_avgpool = nn.AvgPool2d(kernel_size=[3, 3], stride=[1, 1], padding=1, ceil_mode=False, count_include_pad=False)
        self.features_16_branch_pool_conv = nn.Conv2d(1280, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_16_branch_pool_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_16_branch_pool_relu = nn.ReLU()
        self.features_17_branch1x1_conv = nn.Conv2d(2048, 320, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_17_branch1x1_bn = nn.BatchNorm2d(320, eps=0.001, momentum=0.1, affine=True)
        self.features_17_branch1x1_relu = nn.ReLU()
        self.features_17_branch3x3_1_conv = nn.Conv2d(2048, 384, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_17_branch3x3_1_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_17_branch3x3_1_relu = nn.ReLU()
        self.features_17_branch3x3_2a_conv = nn.Conv2d(384, 384, kernel_size=[1, 3], stride=(1, 1), padding=(0, 1), bias=False)
        self.features_17_branch3x3_2a_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_17_branch3x3_2a_relu = nn.ReLU()
        self.features_17_branch3x3_2b_conv = nn.Conv2d(384, 384, kernel_size=[3, 1], stride=(1, 1), padding=(1, 0), bias=False)
        self.features_17_branch3x3_2b_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_17_branch3x3_2b_relu = nn.ReLU()
        self.features_17_branch3x3dbl_1_conv = nn.Conv2d(2048, 448, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_17_branch3x3dbl_1_bn = nn.BatchNorm2d(448, eps=0.001, momentum=0.1, affine=True)
        self.features_17_branch3x3dbl_1_relu = nn.ReLU()
        self.features_17_branch3x3dbl_2_conv = nn.Conv2d(448, 384, kernel_size=[3, 3], stride=(1, 1), padding=(1, 1), bias=False)
        self.features_17_branch3x3dbl_2_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_17_branch3x3dbl_2_relu = nn.ReLU()
        self.features_17_branch3x3dbl_3a_conv = nn.Conv2d(384, 384, kernel_size=[1, 3], stride=(1, 1), padding=(0, 1), bias=False)
        self.features_17_branch3x3dbl_3a_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_17_branch3x3dbl_3a_relu = nn.ReLU()
        self.features_17_branch3x3dbl_3b_conv = nn.Conv2d(384, 384, kernel_size=[3, 1], stride=(1, 1), padding=(1, 0), bias=False)
        self.features_17_branch3x3dbl_3b_bn = nn.BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True)
        self.features_17_branch3x3dbl_3b_relu = nn.ReLU()
        self.features_17_branch_avgpool = nn.AvgPool2d(kernel_size=[3, 3], stride=[1, 1], padding=1, ceil_mode=False, count_include_pad=False)
        self.features_17_branch_pool_conv = nn.Conv2d(2048, 192, kernel_size=[1, 1], stride=(1, 1), bias=False)
        self.features_17_branch_pool_bn = nn.BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True)
        self.features_17_branch_pool_relu = nn.ReLU()
        self.features_18 = nn.AvgPool2d(kernel_size=[8, 8], stride=[8, 8], padding=0, ceil_mode=False, count_include_pad=False)
        self.features_19 = nn.Dropout(p=0.5)
        self.classifier_0 = nn.Linear(in_features=2048, out_features=num_classes, bias=True)

    def forward(self, data):
        feature_list = []
        features_0_conv = self.features_0_conv(data)
        features_0_bn = self.features_0_bn(features_0_conv)
        features_0_relu = self.features_0_relu(features_0_bn)
        features_1_conv = self.features_1_conv(features_0_relu)
        features_1_bn = self.features_1_bn(features_1_conv)
        features_1_relu = self.features_1_relu(features_1_bn)
        features_2_conv = self.features_2_conv(features_1_relu)
        features_2_bn = self.features_2_bn(features_2_conv)
        features_2_relu = self.features_2_relu(features_2_bn)
        features_3 = self.features_3(features_2_relu)
        features_4_conv = self.features_4_conv(features_3)
        features_4_bn = self.features_4_bn(features_4_conv)
        features_4_relu = self.features_4_relu(features_4_bn)
        features_5_conv = self.features_5_conv(features_4_relu)
        features_5_bn = self.features_5_bn(features_5_conv)
        features_5_relu = self.features_5_relu(features_5_bn)
        features_6 = self.features_6(features_5_relu)
        features_7_branch1x1_conv = self.features_7_branch1x1_conv(features_6)
        features_7_branch1x1_bn = self.features_7_branch1x1_bn(features_7_branch1x1_conv)
        features_7_branch1x1_relu = self.features_7_branch1x1_relu(features_7_branch1x1_bn)
        features_7_branch5x5_1_conv = self.features_7_branch5x5_1_conv(features_6)
        features_7_branch5x5_1_bn = self.features_7_branch5x5_1_bn(features_7_branch5x5_1_conv)
        features_7_branch5x5_1_relu = self.features_7_branch5x5_1_relu(features_7_branch5x5_1_bn)
        features_7_branch5x5_2_conv = self.features_7_branch5x5_2_conv(features_7_branch5x5_1_relu)
        features_7_branch5x5_2_bn = self.features_7_branch5x5_2_bn(features_7_branch5x5_2_conv)
        features_7_branch5x5_2_relu = self.features_7_branch5x5_2_relu(features_7_branch5x5_2_bn)
        features_7_branch3x3dbl_1_conv = self.features_7_branch3x3dbl_1_conv(features_6)
        features_7_branch3x3dbl_1_bn = self.features_7_branch3x3dbl_1_bn(features_7_branch3x3dbl_1_conv)
        features_7_branch3x3dbl_1_relu = self.features_7_branch3x3dbl_1_relu(features_7_branch3x3dbl_1_bn)
        features_7_branch3x3dbl_2_conv = self.features_7_branch3x3dbl_2_conv(features_7_branch3x3dbl_1_relu)
        features_7_branch3x3dbl_2_bn = self.features_7_branch3x3dbl_2_bn(features_7_branch3x3dbl_2_conv)
        features_7_branch3x3dbl_2_relu = self.features_7_branch3x3dbl_2_relu(features_7_branch3x3dbl_2_bn)
        features_7_branch3x3dbl_3_conv = self.features_7_branch3x3dbl_3_conv(features_7_branch3x3dbl_2_relu)
        features_7_branch3x3dbl_3_bn = self.features_7_branch3x3dbl_3_bn(features_7_branch3x3dbl_3_conv)
        features_7_branch3x3dbl_3_relu = self.features_7_branch3x3dbl_3_relu(features_7_branch3x3dbl_3_bn)
        features_7_branch_avgpool = self.features_7_branch_avgpool(features_6)
        features_7_branch_pool_conv = self.features_7_branch_pool_conv(features_7_branch_avgpool)
        features_7_branch_pool_bn = self.features_7_branch_pool_bn(features_7_branch_pool_conv)
        features_7_branch_pool_relu = self.features_7_branch_pool_relu(features_7_branch_pool_bn)
        features_7_cat = torch.cat((features_7_branch1x1_relu,features_7_branch5x5_2_relu,features_7_branch3x3dbl_3_relu,features_7_branch_pool_relu), dim=1)
        features_8_branch1x1_conv = self.features_8_branch1x1_conv(features_7_cat)
        features_8_branch1x1_bn = self.features_8_branch1x1_bn(features_8_branch1x1_conv)
        features_8_branch1x1_relu = self.features_8_branch1x1_relu(features_8_branch1x1_bn)
        features_8_branch5x5_1_conv = self.features_8_branch5x5_1_conv(features_7_cat)
        features_8_branch5x5_1_bn = self.features_8_branch5x5_1_bn(features_8_branch5x5_1_conv)
        features_8_branch5x5_1_relu = self.features_8_branch5x5_1_relu(features_8_branch5x5_1_bn)
        features_8_branch5x5_2_conv = self.features_8_branch5x5_2_conv(features_8_branch5x5_1_relu)
        features_8_branch5x5_2_bn = self.features_8_branch5x5_2_bn(features_8_branch5x5_2_conv)
        features_8_branch5x5_2_relu = self.features_8_branch5x5_2_relu(features_8_branch5x5_2_bn)
        features_8_branch3x3dbl_1_conv = self.features_8_branch3x3dbl_1_conv(features_7_cat)
        features_8_branch3x3dbl_1_bn = self.features_8_branch3x3dbl_1_bn(features_8_branch3x3dbl_1_conv)
        features_8_branch3x3dbl_1_relu = self.features_8_branch3x3dbl_1_relu(features_8_branch3x3dbl_1_bn)
        features_8_branch3x3dbl_2_conv = self.features_8_branch3x3dbl_2_conv(features_8_branch3x3dbl_1_relu)
        features_8_branch3x3dbl_2_bn = self.features_8_branch3x3dbl_2_bn(features_8_branch3x3dbl_2_conv)
        features_8_branch3x3dbl_2_relu = self.features_8_branch3x3dbl_2_relu(features_8_branch3x3dbl_2_bn)
        features_8_branch3x3dbl_3_conv = self.features_8_branch3x3dbl_3_conv(features_8_branch3x3dbl_2_relu)
        features_8_branch3x3dbl_3_bn = self.features_8_branch3x3dbl_3_bn(features_8_branch3x3dbl_3_conv)
        features_8_branch3x3dbl_3_relu = self.features_8_branch3x3dbl_3_relu(features_8_branch3x3dbl_3_bn)
        features_8_branch_avgpool = self.features_8_branch_avgpool(features_7_cat)
        features_8_branch_pool_conv = self.features_8_branch_pool_conv(features_8_branch_avgpool)
        features_8_branch_pool_bn = self.features_8_branch_pool_bn(features_8_branch_pool_conv)
        features_8_branch_pool_relu = self.features_8_branch_pool_relu(features_8_branch_pool_bn)
        features_8_cat = torch.cat((features_8_branch1x1_relu,features_8_branch5x5_2_relu,features_8_branch3x3dbl_3_relu,features_8_branch_pool_relu), dim=1)
        features_9_branch1x1_conv = self.features_9_branch1x1_conv(features_8_cat)
        features_9_branch1x1_bn = self.features_9_branch1x1_bn(features_9_branch1x1_conv)
        features_9_branch1x1_relu = self.features_9_branch1x1_relu(features_9_branch1x1_bn)
        features_9_branch5x5_1_conv = self.features_9_branch5x5_1_conv(features_8_cat)
        features_9_branch5x5_1_bn = self.features_9_branch5x5_1_bn(features_9_branch5x5_1_conv)
        features_9_branch5x5_1_relu = self.features_9_branch5x5_1_relu(features_9_branch5x5_1_bn)
        features_9_branch5x5_2_conv = self.features_9_branch5x5_2_conv(features_9_branch5x5_1_relu)
        features_9_branch5x5_2_bn = self.features_9_branch5x5_2_bn(features_9_branch5x5_2_conv)
        features_9_branch5x5_2_relu = self.features_9_branch5x5_2_relu(features_9_branch5x5_2_bn)
        features_9_branch3x3dbl_1_conv = self.features_9_branch3x3dbl_1_conv(features_8_cat)
        features_9_branch3x3dbl_1_bn = self.features_9_branch3x3dbl_1_bn(features_9_branch3x3dbl_1_conv)
        features_9_branch3x3dbl_1_relu = self.features_9_branch3x3dbl_1_relu(features_9_branch3x3dbl_1_bn)
        features_9_branch3x3dbl_2_conv = self.features_9_branch3x3dbl_2_conv(features_9_branch3x3dbl_1_relu)
        features_9_branch3x3dbl_2_bn = self.features_9_branch3x3dbl_2_bn(features_9_branch3x3dbl_2_conv)
        features_9_branch3x3dbl_2_relu = self.features_9_branch3x3dbl_2_relu(features_9_branch3x3dbl_2_bn)
        features_9_branch3x3dbl_3_conv = self.features_9_branch3x3dbl_3_conv(features_9_branch3x3dbl_2_relu)
        features_9_branch3x3dbl_3_bn = self.features_9_branch3x3dbl_3_bn(features_9_branch3x3dbl_3_conv)
        features_9_branch3x3dbl_3_relu = self.features_9_branch3x3dbl_3_relu(features_9_branch3x3dbl_3_bn)
        features_9_branch_avgpool = self.features_9_branch_avgpool(features_8_cat)
        features_9_branch_pool_conv = self.features_9_branch_pool_conv(features_9_branch_avgpool)
        features_9_branch_pool_bn = self.features_9_branch_pool_bn(features_9_branch_pool_conv)
        features_9_branch_pool_relu = self.features_9_branch_pool_relu(features_9_branch_pool_bn)
        features_9_cat = torch.cat((features_9_branch1x1_relu,features_9_branch5x5_2_relu,features_9_branch3x3dbl_3_relu,features_9_branch_pool_relu), dim=1)
        features_10_branch3x3_conv = self.features_10_branch3x3_conv(features_9_cat)
        features_10_branch3x3_bn = self.features_10_branch3x3_bn(features_10_branch3x3_conv)
        features_10_branch3x3_relu = self.features_10_branch3x3_relu(features_10_branch3x3_bn)
        features_10_branch3x3dbl_1_conv = self.features_10_branch3x3dbl_1_conv(features_9_cat)
        features_10_branch3x3dbl_1_bn = self.features_10_branch3x3dbl_1_bn(features_10_branch3x3dbl_1_conv)
        features_10_branch3x3dbl_1_relu = self.features_10_branch3x3dbl_1_relu(features_10_branch3x3dbl_1_bn)
        features_10_branch3x3dbl_2_conv = self.features_10_branch3x3dbl_2_conv(features_10_branch3x3dbl_1_relu)
        features_10_branch3x3dbl_2_bn = self.features_10_branch3x3dbl_2_bn(features_10_branch3x3dbl_2_conv)
        features_10_branch3x3dbl_2_relu = self.features_10_branch3x3dbl_2_relu(features_10_branch3x3dbl_2_bn)
        features_10_branch3x3dbl_3_conv = self.features_10_branch3x3dbl_3_conv(features_10_branch3x3dbl_2_relu)
        features_10_branch3x3dbl_3_bn = self.features_10_branch3x3dbl_3_bn(features_10_branch3x3dbl_3_conv)
        features_10_branch3x3dbl_3_relu = self.features_10_branch3x3dbl_3_relu(features_10_branch3x3dbl_3_bn)
        features_10_branch_pool = self.features_10_branch_pool(features_9_cat)
        features_10_cat = torch.cat((features_10_branch3x3_relu,features_10_branch3x3dbl_3_relu,features_10_branch_pool), dim=1)
        features_11_branch1x1_conv = self.features_11_branch1x1_conv(features_10_cat)
        features_11_branch1x1_bn = self.features_11_branch1x1_bn(features_11_branch1x1_conv)
        features_11_branch1x1_relu = self.features_11_branch1x1_relu(features_11_branch1x1_bn)
        features_11_branch7x7_1_conv = self.features_11_branch7x7_1_conv(features_10_cat)
        features_11_branch7x7_1_bn = self.features_11_branch7x7_1_bn(features_11_branch7x7_1_conv)
        features_11_branch7x7_1_relu = self.features_11_branch7x7_1_relu(features_11_branch7x7_1_bn)
        features_11_branch7x7_2_conv = self.features_11_branch7x7_2_conv(features_11_branch7x7_1_relu)
        features_11_branch7x7_2_bn = self.features_11_branch7x7_2_bn(features_11_branch7x7_2_conv)
        features_11_branch7x7_2_relu = self.features_11_branch7x7_2_relu(features_11_branch7x7_2_bn)
        features_11_branch7x7_3_conv = self.features_11_branch7x7_3_conv(features_11_branch7x7_2_relu)
        features_11_branch7x7_3_bn = self.features_11_branch7x7_3_bn(features_11_branch7x7_3_conv)
        features_11_branch7x7_3_relu = self.features_11_branch7x7_3_relu(features_11_branch7x7_3_bn)
        features_11_branch7x7dbl_1_conv = self.features_11_branch7x7dbl_1_conv(features_10_cat)
        features_11_branch7x7dbl_1_bn = self.features_11_branch7x7dbl_1_bn(features_11_branch7x7dbl_1_conv)
        features_11_branch7x7dbl_1_relu = self.features_11_branch7x7dbl_1_relu(features_11_branch7x7dbl_1_bn)
        features_11_branch7x7dbl_2_conv = self.features_11_branch7x7dbl_2_conv(features_11_branch7x7dbl_1_relu)
        features_11_branch7x7dbl_2_bn = self.features_11_branch7x7dbl_2_bn(features_11_branch7x7dbl_2_conv)
        features_11_branch7x7dbl_2_relu = self.features_11_branch7x7dbl_2_relu(features_11_branch7x7dbl_2_bn)
        features_11_branch7x7dbl_3_conv = self.features_11_branch7x7dbl_3_conv(features_11_branch7x7dbl_2_relu)
        features_11_branch7x7dbl_3_bn = self.features_11_branch7x7dbl_3_bn(features_11_branch7x7dbl_3_conv)
        features_11_branch7x7dbl_3_relu = self.features_11_branch7x7dbl_3_relu(features_11_branch7x7dbl_3_bn)
        features_11_branch7x7dbl_4_conv = self.features_11_branch7x7dbl_4_conv(features_11_branch7x7dbl_3_relu)
        features_11_branch7x7dbl_4_bn = self.features_11_branch7x7dbl_4_bn(features_11_branch7x7dbl_4_conv)
        features_11_branch7x7dbl_4_relu = self.features_11_branch7x7dbl_4_relu(features_11_branch7x7dbl_4_bn)
        features_11_branch7x7dbl_5_conv = self.features_11_branch7x7dbl_5_conv(features_11_branch7x7dbl_4_relu)
        features_11_branch7x7dbl_5_bn = self.features_11_branch7x7dbl_5_bn(features_11_branch7x7dbl_5_conv)
        features_11_branch7x7dbl_5_relu = self.features_11_branch7x7dbl_5_relu(features_11_branch7x7dbl_5_bn)
        features_11_branch_avgpool = self.features_11_branch_avgpool(features_10_cat)
        features_11_branch_pool_conv = self.features_11_branch_pool_conv(features_11_branch_avgpool)
        features_11_branch_pool_bn = self.features_11_branch_pool_bn(features_11_branch_pool_conv)
        features_11_branch_pool_relu = self.features_11_branch_pool_relu(features_11_branch_pool_bn)
        features_11_cat = torch.cat((features_11_branch1x1_relu,features_11_branch7x7_3_relu,features_11_branch7x7dbl_5_relu,features_11_branch_pool_relu), dim=1)
        features_12_branch1x1_conv = self.features_12_branch1x1_conv(features_11_cat)
        features_12_branch1x1_bn = self.features_12_branch1x1_bn(features_12_branch1x1_conv)
        features_12_branch1x1_relu = self.features_12_branch1x1_relu(features_12_branch1x1_bn)
        features_12_branch7x7_1_conv = self.features_12_branch7x7_1_conv(features_11_cat)
        features_12_branch7x7_1_bn = self.features_12_branch7x7_1_bn(features_12_branch7x7_1_conv)
        features_12_branch7x7_1_relu = self.features_12_branch7x7_1_relu(features_12_branch7x7_1_bn)
        features_12_branch7x7_2_conv = self.features_12_branch7x7_2_conv(features_12_branch7x7_1_relu)
        features_12_branch7x7_2_bn = self.features_12_branch7x7_2_bn(features_12_branch7x7_2_conv)
        features_12_branch7x7_2_relu = self.features_12_branch7x7_2_relu(features_12_branch7x7_2_bn)
        features_12_branch7x7_3_conv = self.features_12_branch7x7_3_conv(features_12_branch7x7_2_relu)
        features_12_branch7x7_3_bn = self.features_12_branch7x7_3_bn(features_12_branch7x7_3_conv)
        features_12_branch7x7_3_relu = self.features_12_branch7x7_3_relu(features_12_branch7x7_3_bn)
        features_12_branch7x7dbl_1_conv = self.features_12_branch7x7dbl_1_conv(features_11_cat)
        features_12_branch7x7dbl_1_bn = self.features_12_branch7x7dbl_1_bn(features_12_branch7x7dbl_1_conv)
        features_12_branch7x7dbl_1_relu = self.features_12_branch7x7dbl_1_relu(features_12_branch7x7dbl_1_bn)
        features_12_branch7x7dbl_2_conv = self.features_12_branch7x7dbl_2_conv(features_12_branch7x7dbl_1_relu)
        features_12_branch7x7dbl_2_bn = self.features_12_branch7x7dbl_2_bn(features_12_branch7x7dbl_2_conv)
        features_12_branch7x7dbl_2_relu = self.features_12_branch7x7dbl_2_relu(features_12_branch7x7dbl_2_bn)
        features_12_branch7x7dbl_3_conv = self.features_12_branch7x7dbl_3_conv(features_12_branch7x7dbl_2_relu)
        features_12_branch7x7dbl_3_bn = self.features_12_branch7x7dbl_3_bn(features_12_branch7x7dbl_3_conv)
        features_12_branch7x7dbl_3_relu = self.features_12_branch7x7dbl_3_relu(features_12_branch7x7dbl_3_bn)
        features_12_branch7x7dbl_4_conv = self.features_12_branch7x7dbl_4_conv(features_12_branch7x7dbl_3_relu)
        features_12_branch7x7dbl_4_bn = self.features_12_branch7x7dbl_4_bn(features_12_branch7x7dbl_4_conv)
        features_12_branch7x7dbl_4_relu = self.features_12_branch7x7dbl_4_relu(features_12_branch7x7dbl_4_bn)
        features_12_branch7x7dbl_5_conv = self.features_12_branch7x7dbl_5_conv(features_12_branch7x7dbl_4_relu)
        features_12_branch7x7dbl_5_bn = self.features_12_branch7x7dbl_5_bn(features_12_branch7x7dbl_5_conv)
        features_12_branch7x7dbl_5_relu = self.features_12_branch7x7dbl_5_relu(features_12_branch7x7dbl_5_bn)
        features_12_branch_avgpool = self.features_12_branch_avgpool(features_11_cat)
        features_12_branch_pool_conv = self.features_12_branch_pool_conv(features_12_branch_avgpool)
        features_12_branch_pool_bn = self.features_12_branch_pool_bn(features_12_branch_pool_conv)
        features_12_branch_pool_relu = self.features_12_branch_pool_relu(features_12_branch_pool_bn)
        features_12_cat = torch.cat((features_12_branch1x1_relu,features_12_branch7x7_3_relu,features_12_branch7x7dbl_5_relu,features_12_branch_pool_relu), dim=1)
        features_13_branch1x1_conv = self.features_13_branch1x1_conv(features_12_cat)
        features_13_branch1x1_bn = self.features_13_branch1x1_bn(features_13_branch1x1_conv)
        features_13_branch1x1_relu = self.features_13_branch1x1_relu(features_13_branch1x1_bn)
        features_13_branch7x7_1_conv = self.features_13_branch7x7_1_conv(features_12_cat)
        features_13_branch7x7_1_bn = self.features_13_branch7x7_1_bn(features_13_branch7x7_1_conv)
        features_13_branch7x7_1_relu = self.features_13_branch7x7_1_relu(features_13_branch7x7_1_bn)
        features_13_branch7x7_2_conv = self.features_13_branch7x7_2_conv(features_13_branch7x7_1_relu)
        features_13_branch7x7_2_bn = self.features_13_branch7x7_2_bn(features_13_branch7x7_2_conv)
        features_13_branch7x7_2_relu = self.features_13_branch7x7_2_relu(features_13_branch7x7_2_bn)
        features_13_branch7x7_3_conv = self.features_13_branch7x7_3_conv(features_13_branch7x7_2_relu)
        features_13_branch7x7_3_bn = self.features_13_branch7x7_3_bn(features_13_branch7x7_3_conv)
        features_13_branch7x7_3_relu = self.features_13_branch7x7_3_relu(features_13_branch7x7_3_bn)
        features_13_branch7x7dbl_1_conv = self.features_13_branch7x7dbl_1_conv(features_12_cat)
        features_13_branch7x7dbl_1_bn = self.features_13_branch7x7dbl_1_bn(features_13_branch7x7dbl_1_conv)
        features_13_branch7x7dbl_1_relu = self.features_13_branch7x7dbl_1_relu(features_13_branch7x7dbl_1_bn)
        features_13_branch7x7dbl_2_conv = self.features_13_branch7x7dbl_2_conv(features_13_branch7x7dbl_1_relu)
        features_13_branch7x7dbl_2_bn = self.features_13_branch7x7dbl_2_bn(features_13_branch7x7dbl_2_conv)
        features_13_branch7x7dbl_2_relu = self.features_13_branch7x7dbl_2_relu(features_13_branch7x7dbl_2_bn)
        features_13_branch7x7dbl_3_conv = self.features_13_branch7x7dbl_3_conv(features_13_branch7x7dbl_2_relu)
        features_13_branch7x7dbl_3_bn = self.features_13_branch7x7dbl_3_bn(features_13_branch7x7dbl_3_conv)
        features_13_branch7x7dbl_3_relu = self.features_13_branch7x7dbl_3_relu(features_13_branch7x7dbl_3_bn)
        features_13_branch7x7dbl_4_conv = self.features_13_branch7x7dbl_4_conv(features_13_branch7x7dbl_3_relu)
        features_13_branch7x7dbl_4_bn = self.features_13_branch7x7dbl_4_bn(features_13_branch7x7dbl_4_conv)
        features_13_branch7x7dbl_4_relu = self.features_13_branch7x7dbl_4_relu(features_13_branch7x7dbl_4_bn)
        features_13_branch7x7dbl_5_conv = self.features_13_branch7x7dbl_5_conv(features_13_branch7x7dbl_4_relu)
        features_13_branch7x7dbl_5_bn = self.features_13_branch7x7dbl_5_bn(features_13_branch7x7dbl_5_conv)
        features_13_branch7x7dbl_5_relu = self.features_13_branch7x7dbl_5_relu(features_13_branch7x7dbl_5_bn)
        features_13_branch_avgpool = self.features_13_branch_avgpool(features_12_cat)
        features_13_branch_pool_conv = self.features_13_branch_pool_conv(features_13_branch_avgpool)
        features_13_branch_pool_bn = self.features_13_branch_pool_bn(features_13_branch_pool_conv)
        features_13_branch_pool_relu = self.features_13_branch_pool_relu(features_13_branch_pool_bn)
        features_13_cat = torch.cat((features_13_branch1x1_relu,features_13_branch7x7_3_relu,features_13_branch7x7dbl_5_relu,features_13_branch_pool_relu), dim=1)
        features_14_branch1x1_conv = self.features_14_branch1x1_conv(features_13_cat)
        features_14_branch1x1_bn = self.features_14_branch1x1_bn(features_14_branch1x1_conv)
        features_14_branch1x1_relu = self.features_14_branch1x1_relu(features_14_branch1x1_bn)
        features_14_branch7x7_1_conv = self.features_14_branch7x7_1_conv(features_13_cat)
        features_14_branch7x7_1_bn = self.features_14_branch7x7_1_bn(features_14_branch7x7_1_conv)
        features_14_branch7x7_1_relu = self.features_14_branch7x7_1_relu(features_14_branch7x7_1_bn)
        features_14_branch7x7_2_conv = self.features_14_branch7x7_2_conv(features_14_branch7x7_1_relu)
        features_14_branch7x7_2_bn = self.features_14_branch7x7_2_bn(features_14_branch7x7_2_conv)
        features_14_branch7x7_2_relu = self.features_14_branch7x7_2_relu(features_14_branch7x7_2_bn)
        features_14_branch7x7_3_conv = self.features_14_branch7x7_3_conv(features_14_branch7x7_2_relu)
        features_14_branch7x7_3_bn = self.features_14_branch7x7_3_bn(features_14_branch7x7_3_conv)
        features_14_branch7x7_3_relu = self.features_14_branch7x7_3_relu(features_14_branch7x7_3_bn)
        features_14_branch7x7dbl_1_conv = self.features_14_branch7x7dbl_1_conv(features_13_cat)
        features_14_branch7x7dbl_1_bn = self.features_14_branch7x7dbl_1_bn(features_14_branch7x7dbl_1_conv)
        features_14_branch7x7dbl_1_relu = self.features_14_branch7x7dbl_1_relu(features_14_branch7x7dbl_1_bn)
        features_14_branch7x7dbl_2_conv = self.features_14_branch7x7dbl_2_conv(features_14_branch7x7dbl_1_relu)
        features_14_branch7x7dbl_2_bn = self.features_14_branch7x7dbl_2_bn(features_14_branch7x7dbl_2_conv)
        features_14_branch7x7dbl_2_relu = self.features_14_branch7x7dbl_2_relu(features_14_branch7x7dbl_2_bn)
        features_14_branch7x7dbl_3_conv = self.features_14_branch7x7dbl_3_conv(features_14_branch7x7dbl_2_relu)
        features_14_branch7x7dbl_3_bn = self.features_14_branch7x7dbl_3_bn(features_14_branch7x7dbl_3_conv)
        features_14_branch7x7dbl_3_relu = self.features_14_branch7x7dbl_3_relu(features_14_branch7x7dbl_3_bn)
        features_14_branch7x7dbl_4_conv = self.features_14_branch7x7dbl_4_conv(features_14_branch7x7dbl_3_relu)
        features_14_branch7x7dbl_4_bn = self.features_14_branch7x7dbl_4_bn(features_14_branch7x7dbl_4_conv)
        features_14_branch7x7dbl_4_relu = self.features_14_branch7x7dbl_4_relu(features_14_branch7x7dbl_4_bn)
        features_14_branch7x7dbl_5_conv = self.features_14_branch7x7dbl_5_conv(features_14_branch7x7dbl_4_relu)
        features_14_branch7x7dbl_5_bn = self.features_14_branch7x7dbl_5_bn(features_14_branch7x7dbl_5_conv)
        features_14_branch7x7dbl_5_relu = self.features_14_branch7x7dbl_5_relu(features_14_branch7x7dbl_5_bn)
        features_14_branch_avgpool = self.features_14_branch_avgpool(features_13_cat)
        features_14_branch_pool_conv = self.features_14_branch_pool_conv(features_14_branch_avgpool)
        features_14_branch_pool_bn = self.features_14_branch_pool_bn(features_14_branch_pool_conv)
        features_14_branch_pool_relu = self.features_14_branch_pool_relu(features_14_branch_pool_bn)
        features_14_cat = torch.cat((features_14_branch1x1_relu,features_14_branch7x7_3_relu,features_14_branch7x7dbl_5_relu,features_14_branch_pool_relu), dim=1)
        features_15_branch3x3_1_conv = self.features_15_branch3x3_1_conv(features_14_cat)
        features_15_branch3x3_1_bn = self.features_15_branch3x3_1_bn(features_15_branch3x3_1_conv)
        features_15_branch3x3_1_relu = self.features_15_branch3x3_1_relu(features_15_branch3x3_1_bn)
        features_15_branch3x3_2_conv = self.features_15_branch3x3_2_conv(features_15_branch3x3_1_relu)
        features_15_branch3x3_2_bn = self.features_15_branch3x3_2_bn(features_15_branch3x3_2_conv)
        features_15_branch3x3_2_relu = self.features_15_branch3x3_2_relu(features_15_branch3x3_2_bn)
        features_15_branch7x7x3_1_conv = self.features_15_branch7x7x3_1_conv(features_14_cat)
        features_15_branch7x7x3_1_bn = self.features_15_branch7x7x3_1_bn(features_15_branch7x7x3_1_conv)
        features_15_branch7x7x3_1_relu = self.features_15_branch7x7x3_1_relu(features_15_branch7x7x3_1_bn)
        features_15_branch7x7x3_2_conv = self.features_15_branch7x7x3_2_conv(features_15_branch7x7x3_1_relu)
        features_15_branch7x7x3_2_bn = self.features_15_branch7x7x3_2_bn(features_15_branch7x7x3_2_conv)
        features_15_branch7x7x3_2_relu = self.features_15_branch7x7x3_2_relu(features_15_branch7x7x3_2_bn)
        features_15_branch7x7x3_3_conv = self.features_15_branch7x7x3_3_conv(features_15_branch7x7x3_2_relu)
        features_15_branch7x7x3_3_bn = self.features_15_branch7x7x3_3_bn(features_15_branch7x7x3_3_conv)
        features_15_branch7x7x3_3_relu = self.features_15_branch7x7x3_3_relu(features_15_branch7x7x3_3_bn)
        features_15_branch7x7x3_4_conv = self.features_15_branch7x7x3_4_conv(features_15_branch7x7x3_3_relu)
        features_15_branch7x7x3_4_bn = self.features_15_branch7x7x3_4_bn(features_15_branch7x7x3_4_conv)
        features_15_branch7x7x3_4_relu = self.features_15_branch7x7x3_4_relu(features_15_branch7x7x3_4_bn)
        features_15_branch_maxpool = self.features_15_branch_maxpool(features_14_cat)
        features_15_cat = torch.cat((features_15_branch3x3_2_relu,features_15_branch7x7x3_4_relu,features_15_branch_maxpool), dim=1)
        features_16_branch1x1_conv = self.features_16_branch1x1_conv(features_15_cat)
        features_16_branch1x1_bn = self.features_16_branch1x1_bn(features_16_branch1x1_conv)
        features_16_branch1x1_relu = self.features_16_branch1x1_relu(features_16_branch1x1_bn)
        features_16_branch3x3_1_conv = self.features_16_branch3x3_1_conv(features_15_cat)
        features_16_branch3x3_1_bn = self.features_16_branch3x3_1_bn(features_16_branch3x3_1_conv)
        features_16_branch3x3_1_relu = self.features_16_branch3x3_1_relu(features_16_branch3x3_1_bn)
        features_16_branch3x3_2a_conv = self.features_16_branch3x3_2a_conv(features_16_branch3x3_1_relu)
        features_16_branch3x3_2a_bn = self.features_16_branch3x3_2a_bn(features_16_branch3x3_2a_conv)
        features_16_branch3x3_2a_relu = self.features_16_branch3x3_2a_relu(features_16_branch3x3_2a_bn)
        features_16_branch3x3_2b_conv = self.features_16_branch3x3_2b_conv(features_16_branch3x3_1_relu)
        features_16_branch3x3_2b_bn = self.features_16_branch3x3_2b_bn(features_16_branch3x3_2b_conv)
        features_16_branch3x3_2b_relu = self.features_16_branch3x3_2b_relu(features_16_branch3x3_2b_bn)
        features_16_branch2_cat = torch.cat((features_16_branch3x3_2a_relu,features_16_branch3x3_2b_relu), dim=1)
        features_16_branch3x3dbl_1_conv = self.features_16_branch3x3dbl_1_conv(features_15_cat)
        features_16_branch3x3dbl_1_bn = self.features_16_branch3x3dbl_1_bn(features_16_branch3x3dbl_1_conv)
        features_16_branch3x3dbl_1_relu = self.features_16_branch3x3dbl_1_relu(features_16_branch3x3dbl_1_bn)
        features_16_branch3x3dbl_2_conv = self.features_16_branch3x3dbl_2_conv(features_16_branch3x3dbl_1_relu)
        features_16_branch3x3dbl_2_bn = self.features_16_branch3x3dbl_2_bn(features_16_branch3x3dbl_2_conv)
        features_16_branch3x3dbl_2_relu = self.features_16_branch3x3dbl_2_relu(features_16_branch3x3dbl_2_bn)
        features_16_branch3x3dbl_3a_conv = self.features_16_branch3x3dbl_3a_conv(features_16_branch3x3dbl_2_relu)
        features_16_branch3x3dbl_3a_bn = self.features_16_branch3x3dbl_3a_bn(features_16_branch3x3dbl_3a_conv)
        features_16_branch3x3dbl_3a_relu = self.features_16_branch3x3dbl_3a_relu(features_16_branch3x3dbl_3a_bn)
        features_16_branch3x3dbl_3b_conv = self.features_16_branch3x3dbl_3b_conv(features_16_branch3x3dbl_2_relu)
        features_16_branch3x3dbl_3b_bn = self.features_16_branch3x3dbl_3b_bn(features_16_branch3x3dbl_3b_conv)
        features_16_branch3x3dbl_3b_relu = self.features_16_branch3x3dbl_3b_relu(features_16_branch3x3dbl_3b_bn)
        features_16_branch3_cat = torch.cat((features_16_branch3x3dbl_3a_relu,features_16_branch3x3dbl_3b_relu), dim=1)
        features_16_branch_avgpool = self.features_16_branch_avgpool(features_15_cat)
        features_16_branch_pool_conv = self.features_16_branch_pool_conv(features_16_branch_avgpool)
        features_16_branch_pool_bn = self.features_16_branch_pool_bn(features_16_branch_pool_conv)
        features_16_branch_pool_relu = self.features_16_branch_pool_relu(features_16_branch_pool_bn)
        features_16_cat = torch.cat((features_16_branch1x1_relu,features_16_branch2_cat,features_16_branch3_cat,features_16_branch_pool_relu), dim=1)
        features_17_branch1x1_conv = self.features_17_branch1x1_conv(features_16_cat)
        features_17_branch1x1_bn = self.features_17_branch1x1_bn(features_17_branch1x1_conv)
        features_17_branch1x1_relu = self.features_17_branch1x1_relu(features_17_branch1x1_bn)
        features_17_branch3x3_1_conv = self.features_17_branch3x3_1_conv(features_16_cat)
        features_17_branch3x3_1_bn = self.features_17_branch3x3_1_bn(features_17_branch3x3_1_conv)
        features_17_branch3x3_1_relu = self.features_17_branch3x3_1_relu(features_17_branch3x3_1_bn)
        features_17_branch3x3_2a_conv = self.features_17_branch3x3_2a_conv(features_17_branch3x3_1_relu)
        features_17_branch3x3_2a_bn = self.features_17_branch3x3_2a_bn(features_17_branch3x3_2a_conv)
        features_17_branch3x3_2a_relu = self.features_17_branch3x3_2a_relu(features_17_branch3x3_2a_bn)
        features_17_branch3x3_2b_conv = self.features_17_branch3x3_2b_conv(features_17_branch3x3_1_relu)
        features_17_branch3x3_2b_bn = self.features_17_branch3x3_2b_bn(features_17_branch3x3_2b_conv)
        features_17_branch3x3_2b_relu = self.features_17_branch3x3_2b_relu(features_17_branch3x3_2b_bn)
        features_17_branch2_cat = torch.cat((features_17_branch3x3_2a_relu,features_17_branch3x3_2b_relu), dim=1)
        features_17_branch3x3dbl_1_conv = self.features_17_branch3x3dbl_1_conv(features_16_cat)
        features_17_branch3x3dbl_1_bn = self.features_17_branch3x3dbl_1_bn(features_17_branch3x3dbl_1_conv)
        features_17_branch3x3dbl_1_relu = self.features_17_branch3x3dbl_1_relu(features_17_branch3x3dbl_1_bn)
        features_17_branch3x3dbl_2_conv = self.features_17_branch3x3dbl_2_conv(features_17_branch3x3dbl_1_relu)
        features_17_branch3x3dbl_2_bn = self.features_17_branch3x3dbl_2_bn(features_17_branch3x3dbl_2_conv)
        features_17_branch3x3dbl_2_relu = self.features_17_branch3x3dbl_2_relu(features_17_branch3x3dbl_2_bn)
        features_17_branch3x3dbl_3a_conv = self.features_17_branch3x3dbl_3a_conv(features_17_branch3x3dbl_2_relu)
        features_17_branch3x3dbl_3a_bn = self.features_17_branch3x3dbl_3a_bn(features_17_branch3x3dbl_3a_conv)
        features_17_branch3x3dbl_3a_relu = self.features_17_branch3x3dbl_3a_relu(features_17_branch3x3dbl_3a_bn)
        features_17_branch3x3dbl_3b_conv = self.features_17_branch3x3dbl_3b_conv(features_17_branch3x3dbl_2_relu)
        features_17_branch3x3dbl_3b_bn = self.features_17_branch3x3dbl_3b_bn(features_17_branch3x3dbl_3b_conv)
        features_17_branch3x3dbl_3b_relu = self.features_17_branch3x3dbl_3b_relu(features_17_branch3x3dbl_3b_bn)
        features_17_branch3_cat = torch.cat((features_17_branch3x3dbl_3a_relu,features_17_branch3x3dbl_3b_relu), dim=1)
        features_17_branch_avgpool = self.features_17_branch_avgpool(features_16_cat)
        features_17_branch_pool_conv = self.features_17_branch_pool_conv(features_17_branch_avgpool)
        features_17_branch_pool_bn = self.features_17_branch_pool_bn(features_17_branch_pool_conv)
        features_17_branch_pool_relu = self.features_17_branch_pool_relu(features_17_branch_pool_bn)
        features_17_cat = torch.cat((features_17_branch1x1_relu,features_17_branch2_cat,features_17_branch3_cat,features_17_branch_pool_relu), dim=1)
        features_18 = self.features_18(features_17_cat)
        features_19 = self.features_19(features_18)
        classifier_flatten = features_19.view(features_19.size(0), -1)
        classifier_0 = self.classifier_0(classifier_flatten)
        # print(features_17_cat.shape)  # 8 * 8
        # print(features_14_cat.shape)  # 17 * 17
        # print(features_9_cat.shape)  # 35 * 35
        feature_list = [features_9_cat, features_14_cat, features_17_cat]
        return classifier_0, feature_list


def inception_v3(num_classes, weights_path=None, **kwargs):
    """
    load imported model instance

    Args:
        weights_path (str): If set, loads model weights from the given path
    """
    model = InceptionV3(num_classes)
    if weights_path:
        state_dict = torch.load(weights_path)
        model.load_state_dict(state_dict)
    return model


if __name__ == "__main__":
    inputs = torch.rand((1, 3, 299, 299))
    model = inception_v3(2)
    cls, outputs = model(inputs)
    print(cls.size())
    for o in outputs:
        print(o.size())
